/*************************************************************************
 *
 * MODULE NAME:    rdabt_r11_init.c
 * PROJECT CODE:   rdabt
 * DESCRIPTION:    rda bt r11 initiation.
 * MAINTAINER:     mql
 * CREATION DATE:  05/11/10
 *
 * SOURCE CONTROL: $Id: rdabt_r11_init.c 5857 2011-02-12 09:15:12Z huazeng $
 *
 * LICENSE:
 *     This source code is copyright (c) 2010-2011 rda.
 *     All rights reserved.
 *
 * NOTES TO USERS:
 *   
 *   version 3.23
 *				 
 *************************************************************************/

#ifdef __BT_RDABT__
#include "kal_release.h"      	/* Basic data type */
#include "stack_common.h"          /* message and module IDs */
#include "stack_msgs.h"            /* enum for message IDs */
#include "app_ltlcom.h"       	/* Task message communiction */
//#include "syscomp_config.h"         /* type of system module components */
//#include "task_config.h"      	/* Task creation */
#include "stacklib.h"        	   /* Basic type for dll, evshed, stacktimer */
#include "event_shed.h"       	/* Event scheduler */
#include "stack_timer.h"      	/* Stack timer */
#include "stdio.h"                  /* Basic C I/O functions */
//#include "eint.h"                   /* External interrupt */

#include "uart_sw.h"               /* header file for UART */
#include "rdabt_drv.h"


#if defined( __RDA_CHIP_R11_5872P__)  || defined( __RDA_CHIP_R11_5875__) 




const kal_uint32 rda_pskey_11[][2] =
{
{0x800000a8,0x0Bbfbf30},//min power level
{0x80000070,0x00002008},
{0x80000040,0x04001000},//PSKEY: modify flag
#ifdef _RDA_PATCH_UART3_
{0x80000064,0x0030d400},//new baudrate 3200000
{0x80000040,0x00000200},
#endif

#ifndef __RDA_SHARE_CRYSTAL__
#endif
};



const const kal_uint32 rda_trap_11[][2] = 
{
#if 0
{0x40180004,0x0000bb1c},
{0x40180024,0x0000fd60},
{0x80000050,0xe3a090ff},
{0x40180008,0x0000ba50},
{0x40180028,0x80000050},
{0x40180000,0x00000003}
#endif
#ifdef __RDA_ESERMODE_CHANGE__
{0x80008b94,0xe3c23001},
{0x40180004,0x00006344},
{0x40180024,0x80008b94},
{0x80000000,0xea0022f4},
{0x40180008,0x00005fdc},
{0x40180028,0x00032d30},
{0x80000004,0xea0023d3},
{0x4018000c,0x0002c6b4},
{0x4018002c,0x00032d34},
{0x80000008,0xea0023e9},
{0x40180010,0x00005cf8},
{0x40180030,0x00032d38},
{0x8000000c,0xea002458},
{0x40180014,0x0002c870},
{0x40180034,0x00032d3c},
{0x40180018,0x000055cc},
{0x40180038,0x0000b8a8},
{0x4018001c,0x0002c698},
{0x4018003c,0x0000b8a8},
{0x80000010,0xea00247d},
{0x40180020,0x000059a0},
{0x40180040,0x00032d40},
{0x40180000,0x000000ff},

#endif

{0x40180100,0x00013158},//:    e3a00064    d...    MOV      r0,#0x64
{0x40180120,0x00027e68},
{0x40180104,0x00013240},//:    e3a00064    d...    MOV      r0,#0x64
{0x40180124,0x00027e68},

{0x40180108,0x0002ED2C},
{0x40180128,0x000309E4},
{0x80008ba8,0xe3a01007},
{0x4018010c,0x0001cec8},
{0x4018012c,0x80008ba8},
{0x40180110,0x00002A98},
{0x40180130,0x00003074},


#ifdef __RDA_ESERMODE_CHANGE__
{0x40180000,0x00001fff},
#else
{0x40180000,0x00001f00},
#endif

};


#ifdef __RDA_ESERMODE_CHANGE__
const kal_uint32 rda_esermode_patch_11[][62]=
{
{0x80008bc0,0xe51ff004,0x0000525c,0xe51ff004,0x0002ca1c,0xe51ff004,0x0000521c,0xe92d41f0,0xe1a04000,0xe3500002,0x059f0350,0xe3a06000,0x05c06000,0xe59f0348,0xe3a05470,0xe5d03000,0xe59f0340,0xe5901000,0xe3530002,0xe3c12001,0x1a00005c,0xe59f6330,0xe3540000,0x0a000011,0xe3540001,0x0a00003f,0xe3540002,0x0a000046,0xe3540003,0x1a000050,0xe3c11e70,0xe5801000,0xe5950064,0xe0000001,0xe5850064,0xe3a00003,0xebffffdb,0xe5d61003,0xe3510050,0x33a00003,0x3a000044,0xea000044,0xe3c11d40,0xe5801000,0xe1a00001,0xe5951064,0xe0010000,0xe5850064,0xe3a00003,0xebffffce,0xe5d60000,0xe3500050,0x2a000039,0xe5950158,0xe3c00c80,0xe5850158,0xe5950140,0xe3c00c80,0xe5850140,0xe595015c,0xe3c00c80,0xe585015c},
{0x80008cb4,0xe5950144,0xe3c00c80,0xe5850144,0xe5950160,0xe3c00c80,0xe5850160,0xe5950148,0xe3c00c80,0xe5850148,0xe3a00003,0xebffffb7,0xe5950158,0xe3c00480,0xe5850158,0xe5950140,0xe3c00480,0xe5850140,0xe595015c,0xe3c00480,0xe585015c,0xe5950144,0xe3c00480,0xe5850144,0xe3a00003,0xebffffa9,0xe5d61000,0xe3a00000,0xea000013,0xe5802000,0xe5950064,0xe0000002,0xe5850064,0xe5d61001,0xe3510050,0x33a00001,0x3a00000b,0xea00000b,0xe3c11010,0xe5801000,0xe5950064,0xe0000001,0xe5850064,0xe3a00003,0xebffff96,0xe5d61002,0xe3510050,0x2a000001,0xe3a00002,0xeb00008e,0xe3a0005d,0xe7c60004,0xe8bd81f0,0xe59f81c0,0xe3530001,0xe5d81000,0x1a000003,0xe3510001,0x03540002,0x05c86000,0xe8bd81f0,0xe59f71a4},
{0x80008da8,0xe5d73000,0xe3530000,0x0a000005,0xe3540001,0x05802000,0x05953064,0x00032002,0x05852064,0x05c76000,0xe3510000,0x0a000009,0xe3540003,0x1a000007,0xe1a01000,0xe5900000,0xe3c00e70,0xe5810000,0xe5951064,0xe0010000,0xe5850064,0xe5c86000,0xe3540000,0x18bd81f0,0xe59f4148,0xe5d40000,0xe3500000,0x08bd81f0,0xe3500003,0x1a000043,0xebffff69,0xe5d70000,0xe3500000,0x0a00001d,0xe5950158,0xe3c00c80,0xe5850158,0xe5950140,0xe3c00c80,0xe5850140,0xe5950158,0xe3c00480,0xe5850158,0xe5950140,0xe3c00480,0xe5850140,0xe595015c,0xe3c00c80,0xe585015c,0xe5950144,0xe3c00c80,0xe5850144,0xe595015c,0xe3c00480,0xe585015c,0xe5950144,0xe3c00480,0xe5850144,0xe5950160,0xe3c00c80,0xe5850160,0xe5950148},
{0x80008e9c,0xe3c00c80,0xe5850148,0xe5d80000,0xe3500000,0x0a000020,0xe5950158,0xe3c00480,0xe5850158,0xe5950140,0xe3c00480,0xe5850140,0xe5950158,0xe3c00c80,0xe5850158,0xe5950140,0xe3c00c80,0xe5850140,0xe595015c,0xe3c00480,0xe585015c,0xe5950144,0xe3c00480,0xe5850144,0xe595015c,0xe3c00c80,0xe585015c,0xe5950144,0xe3c00c80,0xe5850144,0xe5950160,0xe3c00c80,0xe5850160,0xe5950148,0xe3c00c80,0xe5850148,0xea000001,0xe3500004,0x0b00008f,0xe5c46000,0xe8bd81f0,0x80002d1c,0x80002d18,0x80002d2c,0x80002d24,0x80002d1e,0x80002d1d,0x80002d1f,0xe92d41f0,0xe1a08000,0xebffff1a,0xe3a04470,0xe5946070,0xe5945064,0xe5947068,0xe59f0034,0xe5840068,0xe0050000,0xe3800940,0xe5840064,0xe3880480,0xe5840070},
{0x80008f90,0xe3a00004,0xebffff09,0xebffff0c,0xe5847068,0xe3c50940,0xe5840064,0xe5846070,0xe8bd81f0,0x0000ffff,0xe92d4ff8,0xe59f416c,0xe59f3168,0xe5942000,0xe3a05470,0xe3822880,0xe5832000,0xe59f2158,0xe5852068,0xe59f3164,0xe3a0c003,0xe5d33000,0xe1a02000,0xe3520005,0xe08c3283,0xe1a03b83,0xe0811823,0xe381b480,0xe38bbb80,0xe59f0138,0xe59fa128,0xe59f6128,0xe59f7128,0xe3a08000,0xe3a09001,0x908ff102,0xea000015,0xea000004,0xea00000a,0xea000013,0xea00001f,0xea000010,0xea00002b,0xe580b000,0xebfffee3,0xe59f0100,0xe580b000,0xe5940000,0xe3800001,0xea000004,0xebfffedd,0xe59f00ec,0xe580b000,0xe5940000,0xe3800010,0xe5840000,0xe5850064,0xe5c79000,0xe5c68000,0xe8bd8ff8,0xebfffed3,0xe59f00c8},
{0x80009084,0xe580b000,0xebfffed0,0xe59f00c0,0xe580a000,0xebfffecd,0xe59f00b8,0xe59f10b8,0xe5801000,0xe5940000,0xe3800e70,0xea000019,0xe580b000,0xebfffec5,0xe59f00a0,0xe580b000,0xebfffec2,0xe59f0098,0xe580a000,0xebfffebf,0xe59f0090,0xe59f1080,0xe5801000,0xe5940000,0xe3800c70,0xea00000b,0xebfffeb8,0xe59f0058,0xe580b000,0xebfffeb5,0xe59f006c,0xe580a000,0xebfffeb2,0xe59f0064,0xe59f104c,0xe5801000,0xe5940000,0xe3800070,0xe5840000,0xe5850064,0xe5c78000,0xe5c69000,0xeaffffd2,0x80002d2c,0x00000145,0x800c85f8,0x80002d1e,0x80002d1d,0x80002d28,0x80002d20,0x70000100,0x70000110,0x70000120,0x70000124,0x70000128,0x800c85e8,0x70000130,0x70000134,0x70000138,0x70000114,0x70000118,0xe59f2074},
{0x80009178,0xe5d20001,0xe26010dd,0xe2811e40,0xe2600f4d,0xe1813800,0xe3a00470,0xe5803140,0xe5d21002,0xe5d2c009,0xe2611015,0xe26cc0be,0xe28cce40,0xe2811f40,0xe181180c,0xe5801158,0xe5803144,0xe580115c,0xe5d21003,0xe26110dd,0xe2811e40,0xe3811480,0xe5801148,0xe5d21004,0xe2611015,0xe2811f40,0xe5801160,0xe3a01000,0xe5801170,0xe5801174,0xe1a0f00e,0x80002d30,0xe51ff004,0x0000525c,0xe51ff004,0x0002c700,0xe51ff004,0x0002c6b4,0xe59f001c,0xebfffffb,0xebfffff8,0xe3a00014,0xebfffff4,0xe59f000c,0xebfffff6,0xe3a00c59,0xe280f0a4,0x800c85f8,0x800c85e8,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000,0x00000000},
};

#endif


const kal_uint8 rdabt_unsniff_prerxon_11[] = {0x01,0x72,0xfc,0x05,0x05,0x64,0x00,0x00,0x00};

#if defined(_RDA_PATCH_UART_)
const kal_uint8 rda_filter_11[] = {0x01,0x72,0xfc,0x05,0x01,0x01,0x00,0x00,0x00};
#elif defined(_RDA_PATCH_UART2_)
const kal_uint8 rda_filter_11[] = {0x01,0x72,0xfc,0x05,0x01,0x02,0x00,0x00,0x00};
#elif defined(_RDA_PATCH_UART3_)
const kal_uint8 rda_filter_11[] = {0x01,0x72,0xfc,0x05,0x01,0x03,0x00,0x00,0x00};
#else
const kal_uint8 rda_filter_11[] = {0x01,0x72,0xfc,0x05,0x01,0x00,0x00,0x00,0x00};
#endif

//////////////////////////////////////////////////////////


#ifdef __RDA_ESERMODE_CHANGE__
void Rdabt_esermode_write_r11(void)
{
   kal_int32 i;
   for(i=0;i<sizeof(rda_esermode_patch_11)/sizeof(rda_esermode_patch_11[0]);i++)
   {
      rdabt_wirte_memory(rda_esermode_patch_11[i][0],&rda_esermode_patch_11[i][1],61,0);
      RDABT_DELAY(10);
   }	
}

#endif


void Rdabt_Pskey_Write_r11(void)
{
   kal_int32 i;
   for(i=0;i<sizeof(rda_pskey_11)/sizeof(rda_pskey_11[0]);i++)
   {
      rdabt_wirte_memory(rda_pskey_11[i][0],&rda_pskey_11[i][1],1,0);
      RDABT_DELAY(2);
   }	
}


void Rdabt_trap_write_r11(void)
{
   kal_int32 i;
   for(i=0;i<sizeof(rda_trap_11)/sizeof(rda_trap_11[0]);i++)
   {
      rdabt_wirte_memory(rda_trap_11[i][0],&rda_trap_11[i][1],1,0);
      RDABT_DELAY(1);
   }	
}





void Rdabt_unsniff_prerxon_write_r11(void)
{
   kal_uint16 num_send;	
   rdabt_uart_tx(rdabt_unsniff_prerxon_11,sizeof(rdabt_unsniff_prerxon_11),&num_send);
   RDABT_DELAY(1);
}



void Rdabt_setfilter_r11(void)
{
   kal_uint16 num_send;	
   rdabt_uart_tx(rda_filter_11,sizeof(rda_filter_11),&num_send);
   RDABT_DELAY(1);
}



#endif//#if defined__RDA_CHIP_R10__ || __RDA_CHIP_R10_5872H__

#endif


